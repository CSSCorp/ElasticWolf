<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<!DOCTYPE window SYSTEM "chrome://ew/locale/ew.dtd">

<dialog id="ew.dialog.instance.detail" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
  buttons="accept" ondialogaccept="return true;" onload="init();" title="Instance Details">

  <script type="application/x-javascript">
    function init() {
        var session = window.arguments[0];
        var instance = window.arguments[1];
        document.getElementById("ew.instance.resid").value = instance.resId;
        document.getElementById("ew.instance.instanceid").value = instance.id;
        document.getElementById("ew.instance.name").value = instance.name;

        var amiLabel = session.getResourceTag(instance.imageId);
        amiLabel = instance.imageId + (amiLabel ? ":" + amiLabel : "");

        document.getElementById("ew.instance.amiid").value = amiLabel;
        document.getElementById("ew.instance.amimanifest").value = session.model.getAmiManifestForId(instance.imageId);
        document.getElementById("ew.instance.akiid").value = instance.kernelId;
        document.getElementById("ew.instance.ariid").value = instance.ramdiskId;
        document.getElementById("ew.instance.ownerid").value = instance.ownerId;
        document.getElementById("ew.instance.publicdnsname").value = instance.publicDnsName;
        document.getElementById("ew.instance.privatednsname").value = instance.privateDnsName;
        document.getElementById("ew.instance.privateipaddress").value = instance.privateIpAddress;
        document.getElementById("ew.instance.publicipaddress").value = getIPFromHostname(instance);
        document.getElementById("ew.instance.keyname").value = instance.keyName;
        document.getElementById("ew.instance.reason").value = instance.reason;
        document.getElementById("ew.instance.amiLaunchIdx").value = instance.amiLaunchIdx;
        document.getElementById("ew.instance.instanceType").value = instance.instanceType;
        document.getElementById("ew.instance.launchTime").value = instance.launchTime.toString();
        document.getElementById("ew.instance.availabilityZone").value = instance.placement.availabilityZone;
        document.getElementById("ew.instance.tenancy").value = instance.placement.tenancy;
        document.getElementById("ew.instance.platform").value = instance.platform;
        document.getElementById("ew.instance.vpcid").value = instance.vpcId;
        document.getElementById("ew.instance.subnetid").value = instance.subnetId;
        document.getElementById("ew.instance.tag").value = instance.tag || "";
        document.getElementById("ew.instance.eip").value = instance.eip;

        var secGroups = document.getElementById("ew.instance.securitygrouplist");
        for(var i in instance.groupList) {
            secGroups.appendItem(instance.groupList[i]);
        }

        var volumeL = document.getElementById("ew.instance.volumelist");
        // Enumerate the volumes associated with the instId
        var volumes = session.model.getVolumes();

        // If a volume is associated with this instance,
        // add it to the list
        var vol = null;
        for (var i in volumes) {
            vol = volumes[i];
            if (vol.instanceId == instance.id) {
                var val = vol.id;
                if (vol.tag) val = val + ":" + vol.tag;
                volumeL.appendItem(val);
            }
        }
    }
  </script>
  <script type="application/x-javascript" src="chrome://ew/content/model.js" />
  <script type="application/x-javascript" src="chrome://ew/content/utils.js" />

  <vbox flex="1">
    <grid flex="1">
      <columns>
        <column />
        <column />
        <column />
        <column />
        <column />
        <column />
      </columns>
      <rows>
        <row>
          <label control="ew.instance.name" value="Name:" />
          <textbox id="ew.instance.name" size="30" readonly="true" />
          <label control="ew.instance.instanceid" value="Instance ID:" />
          <textbox id="ew.instance.instanceid" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.resid" value="Reservation ID:" />
          <textbox id="ew.instance.resid" size="30" readonly="true" />
          <label control="ew.instance.amiid" value="AMI ID:" />
          <textbox id="ew.instance.amiid" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.amimanifest" value="AMI Manifest:" />
          <textbox id="ew.instance.amimanifest" size="30" readonly="true" />
          <label control="ew.instance.akiid" value="AKI ID:" />
          <textbox id="ew.instance.akiid" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.ariid" value="ARI ID:" />
          <textbox id="ew.instance.ariid" size="30" readonly="true" />
          <label control="ew.instance.vpcid" value="VPC ID: "/>
          <textbox id="ew.instance.vpcid" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.subnetid" value="Subnet ID: "/>
          <textbox id="ew.instance.subnetid" size="30" readonly="true" />
          <label control="ew.instance.ownerid" value="Owner ID:" />
          <textbox id="ew.instance.ownerid" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.dnsname" value="Public DNS Name:" />
          <textbox id="ew.instance.publicdnsname" size="30" readonly="true" />
          <label control="ew.instance.dnsname" value="Private DNS Name:" />
          <textbox id="ew.instance.privatednsname" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.publicipaddress" value="Public IP Address:" />
          <textbox id="ew.instance.publicipaddress" size="30" readonly="true" />
          <label control="ew.instance.privateipaddress" value="Private IP Address:" />
          <textbox id="ew.instance.privateipaddress" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.keyname" value="Key Name:" />
          <textbox id="ew.instance.keyname" size="30" readonly="true" />
          <label control="ew.instance.tenancy" value="Tenancy:" />
          <textbox id="ew.instance.tenancy" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.reason" value="Last Reason:" />
          <textbox id="ew.instance.reason" size="30" readonly="true" />
          <label control="ew.instance.amiLaunchIdx" value="AMI Launch Index:" />
          <textbox id="ew.instance.amiLaunchIdx" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.instanceType" value="Instance Type:" />
          <textbox id="ew.instance.instanceType" size="30" readonly="true" />
          <label control="ew.instance.launchTime" value="Launch Time:" />
          <textbox id="ew.instance.launchTime" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.availabilityZone" value="Availability Zone:" />
          <textbox id="ew.instance.availabilityZone" size="30" readonly="true" />
          <label control="ew.instance.platform" value="Platform:" />
          <textbox id="ew.instance.platform" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.tag" value="Tag:" />
          <textbox id="ew.instance.tag" size="30" readonly="true" />
          <label control="ew.instance.eip" value="Elastic IP:" />
          <textbox id="ew.instance.eip" size="30" readonly="true" />
        </row>
        <row>
          <label control="ew.instance.volumelist" value="EBS Volumes:" />
          <listbox id="ew.instance.volumelist" seltype="single" rows="4" flex="1" />
          <label control="ew.instance.securitygrouplist" value="Security Groups:" />
          <listbox id="ew.instance.securitygrouplist" seltype="single" rows="4" flex="1" />
        </row>
      </rows>
    </grid>
  </vbox>
</dialog>

